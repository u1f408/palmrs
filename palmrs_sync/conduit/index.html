<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Sync conduit handling"><title>palmrs_sync::conduit - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-9bb858ba049f1f21.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="palmrs_sync" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0-nightly (85bf07972 2023-07-06)" data-channel="nightly" data-search-js="search-f6292fe389d70017.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../palmrs_sync/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../palmrs_sync/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module conduit</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">palmrs_sync</a>::<wbr><a class="mod" href="#">conduit</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/palmrs_sync/conduit/mod.rs.html#1-209">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Sync conduit handling</p>
<h3 id="conduit-specification"><a href="#conduit-specification">Conduit specification</a></h3>
<p>Conduits are implemented as external executables, which are called at sync time to do one of
three things:</p>
<ul>
<li>Replace the device’s copy of the data with the local copy of the data</li>
<li>Replace the local copy of the data with the data from the device</li>
<li>Merge the local copy of the data with the device’s copy of the data</li>
</ul>
<p>The sync mode, along with other conduit data, is passed in the form of environment variables to
the conduit process.</p>
<h4 id="environment-variables"><a href="#environment-variables">Environment variables</a></h4>
<p>Conduits are always called with the following variables set in their environment:</p>
<ul>
<li><code>PALMRS_SYNC_VERSION</code> - palmrs-sync version number</li>
<li><code>PALMRS_SYNC_MODE</code> - sync mode (one of <code>keep-local</code>, <code>keep-device</code>, or <code>merge</code>)</li>
<li><code>PALMRS_DATA_LOCAL</code> - path to the local data directory for this conduit</li>
<li><code>PALMRS_DATA_DEVICE</code> - path to a directory containing the entire set of Palm OS database
files pulled from the device at the beginning of the sync process</li>
</ul>
<p>In addition, conduits are called with a parsed version of their conduit-specific configuration,
pulled from the palm.rs configuration for the specific device that is being synced, in their
environment. The names of all of these environment variables are prefixed, and that prefix is
passed to the conduit in the <code>PALMRS_CONFIG_PREFIX</code> environment variable.</p>
<p>For example, a test conduit could be called with the following environment:</p>
<div class="example-wrap"><pre class="language-shell"><code>PALMRS_SYNC_VERSION=&quot;0.1.0-dev.1&quot;
PALMRS_SYNC_MODE=&quot;keep-device&quot;
PALMRS_DATA_LOCAL=&quot;/home/user/Documents/palm.rs/conduits/conduit-test&quot;
PALMRS_DATA_DEVICE=&quot;/tmp/palmrs-device-data.27b862fa.tmp&quot;
PALMRS_CONFIG_PREFIX=&quot;CONDUIT_TEST__&quot;
CONDUIT_TEST__HELLO_WORLD=&quot;Hello, world!&quot;
</code></pre></div><h4 id="local-data"><a href="#local-data">Local data</a></h4>
<p>Conduits are free to store whatever data they would like, in whatever format they would like,
in their local data directory (the path to which is specified in the <code>PALMRS_DATA_LOCAL</code>
environment variable passed to the conduit).</p>
<p>It is <em>recommended</em>, but not <em>required</em>, that conduits store their data in a format that is
easily editable by a human - either directly with a text editor, or by using already available
tools.</p>
<h4 id="device-data"><a href="#device-data">Device data</a></h4>
<p>All of the Palm OS database files that have been synced from the device, regardless of whether
or not the specific conduit needs them, will be available in the directory specified by the
<code>PALMRS_DATA_DEVICE</code> environment variable.</p>
<p>The data available in that directory may not be the result of a “full” (i.e. “backup”) sync
with the device - in that case, the partial data from the current sync will be overlaid on top
of the data from the last “full” sync.</p>
<p>When the conduit is operating in <code>keep-local</code> or <code>merge</code> modes, any data written back to any of
the databases in the <code>PALMRS_DATA_DEVICE</code> directory (or, any new database files that are added
to that directory) will be synced back to the device. When the conduit is operating in
<code>keep-device</code> mode, the conduit <em>MAY NOT</em> make changes to the databases in that directory.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.ConduitHandler.html" title="struct palmrs_sync::conduit::ConduitHandler">ConduitHandler</a></div><div class="desc docblock-short">Conduit call handler</div></li><li><div class="item-name"><a class="struct" href="struct.ConduitRequirements.html" title="struct palmrs_sync::conduit::ConduitRequirements">ConduitRequirements</a></div><div class="desc docblock-short">Container (with builder API) for sync conduit requirements</div></li><li><div class="item-name"><a class="struct" href="struct.WithinConduit.html" title="struct palmrs_sync::conduit::WithinConduit">WithinConduit</a></div></li><li><div class="item-name"><a class="struct" href="struct.WithinConduitConfig.html" title="struct palmrs_sync::conduit::WithinConduitConfig">WithinConduitConfig</a></div></li></ul></section></div></main></body></html>