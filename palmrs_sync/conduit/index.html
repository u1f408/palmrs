<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Sync conduit handling"><meta name="keywords" content="rust, rustlang, rust-lang, conduit"><title>palmrs_sync::conduit - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../palmrs_sync/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><h2 class="location">Module conduit</h2><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li></ul></div><div id="sidebar-vars" data-name="conduit" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">palmrs_sync</a>::<wbr><a class="mod" href="#">conduit</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/palmrs_sync/conduit/mod.rs.html#1-209" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Sync conduit handling</p>
<h2 id="conduit-specification" class="section-header"><a href="#conduit-specification">Conduit specification</a></h2>
<p>Conduits are implemented as external executables, which are called at sync time to do one of
three things:</p>
<ul>
<li>Replace the device’s copy of the data with the local copy of the data</li>
<li>Replace the local copy of the data with the data from the device</li>
<li>Merge the local copy of the data with the device’s copy of the data</li>
</ul>
<p>The sync mode, along with other conduit data, is passed in the form of environment variables to
the conduit process.</p>
<h3 id="environment-variables" class="section-header"><a href="#environment-variables">Environment variables</a></h3>
<p>Conduits are always called with the following variables set in their environment:</p>
<ul>
<li><code>PALMRS_SYNC_VERSION</code> - palmrs-sync version number</li>
<li><code>PALMRS_SYNC_MODE</code> - sync mode (one of <code>keep-local</code>, <code>keep-device</code>, or <code>merge</code>)</li>
<li><code>PALMRS_DATA_LOCAL</code> - path to the local data directory for this conduit</li>
<li><code>PALMRS_DATA_DEVICE</code> - path to a directory containing the entire set of Palm OS database
files pulled from the device at the beginning of the sync process</li>
</ul>
<p>In addition, conduits are called with a parsed version of their conduit-specific configuration,
pulled from the palm.rs configuration for the specific device that is being synced, in their
environment. The names of all of these environment variables are prefixed, and that prefix is
passed to the conduit in the <code>PALMRS_CONFIG_PREFIX</code> environment variable.</p>
<p>For example, a test conduit could be called with the following environment:</p>
<div class="example-wrap"><pre class="language-shell"><code>PALMRS_SYNC_VERSION=&quot;0.1.0-dev.1&quot;
PALMRS_SYNC_MODE=&quot;keep-device&quot;
PALMRS_DATA_LOCAL=&quot;/home/user/Documents/palm.rs/conduits/conduit-test&quot;
PALMRS_DATA_DEVICE=&quot;/tmp/palmrs-device-data.27b862fa.tmp&quot;
PALMRS_CONFIG_PREFIX=&quot;CONDUIT_TEST__&quot;
CONDUIT_TEST__HELLO_WORLD=&quot;Hello, world!&quot;</code></pre></div><h3 id="local-data" class="section-header"><a href="#local-data">Local data</a></h3>
<p>Conduits are free to store whatever data they would like, in whatever format they would like,
in their local data directory (the path to which is specified in the <code>PALMRS_DATA_LOCAL</code>
environment variable passed to the conduit).</p>
<p>It is <em>recommended</em>, but not <em>required</em>, that conduits store their data in a format that is
easily editable by a human - either directly with a text editor, or by using already available
tools.</p>
<h3 id="device-data" class="section-header"><a href="#device-data">Device data</a></h3>
<p>All of the Palm OS database files that have been synced from the device, regardless of whether
or not the specific conduit needs them, will be available in the directory specified by the
<code>PALMRS_DATA_DEVICE</code> environment variable.</p>
<p>The data available in that directory may not be the result of a “full” (i.e. “backup”) sync
with the device - in that case, the partial data from the current sync will be overlaid on top
of the data from the last “full” sync.</p>
<p>When the conduit is operating in <code>keep-local</code> or <code>merge</code> modes, any data written back to any of
the databases in the <code>PALMRS_DATA_DEVICE</code> directory (or, any new database files that are added
to that directory) will be synced back to the device. When the conduit is operating in
<code>keep-device</code> mode, the conduit <em>MAY NOT</em> make changes to the databases in that directory.</p>
</div></details><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="struct" href="struct.ConduitHandler.html" title="palmrs_sync::conduit::ConduitHandler struct">ConduitHandler</a></div><div class="item-right docblock-short"><p>Conduit call handler</p>
</div><div class="item-left module-item"><a class="struct" href="struct.ConduitRequirements.html" title="palmrs_sync::conduit::ConduitRequirements struct">ConduitRequirements</a></div><div class="item-right docblock-short"><p>Container (with builder API) for sync conduit requirements</p>
</div><div class="item-left module-item"><a class="struct" href="struct.WithinConduit.html" title="palmrs_sync::conduit::WithinConduit struct">WithinConduit</a></div><div class="item-right docblock-short"></div><div class="item-left module-item"><a class="struct" href="struct.WithinConduitConfig.html" title="palmrs_sync::conduit::WithinConduitConfig struct">WithinConduitConfig</a></div><div class="item-right docblock-short"></div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="palmrs_sync" data-search-index-js="../../search-index.js" data-search-js="../../search.js"></div>
    <script src="../../main.js"></script>
</body></html>